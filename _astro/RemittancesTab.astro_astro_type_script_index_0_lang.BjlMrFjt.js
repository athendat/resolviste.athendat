const f={USD:1,MLC:.65,CUP:365,CLASICA:1},S={USD:"$",MLC:"MLC",CUP:"CUP",CLASICA:"$"};let c="USD";function E(e,t=!1){if(e<0)return{isValid:!1,error:"El monto no puede ser negativo"};if(e===0)return{isValid:!1,error:"El monto debe ser mayor a cero"};if(t){const n=f[c],o=e/n;if(o+5>5e3)return{isValid:!1,error:"El monto máximo de envío es $5000 USD"};if(o<1)return{isValid:!1,error:"El monto mínimo es $1 USD"}}else{if(e>5e3)return{isValid:!1,error:"El monto máximo es $5000 USD"};if(e-5<1)return{isValid:!1,error:"El monto mínimo a recibir es $1 USD (enviar $6 USD)"}}return{isValid:!0}}function u(e,t){s(t);const n=document.getElementById(t);if(n){n.classList.add("border-red-500");const o=document.createElement("p");o.id=`${t}_error`,o.className="mt-1 text-xs text-red-400",o.textContent=e,n.parentNode?.insertBefore(o,n.nextSibling)}}function s(e){const t=document.getElementById(e),n=document.getElementById(`${e}_error`);t&&t.classList.remove("border-red-500"),n&&n.remove()}function m(e,t){l(e),e.classList.add("border-red-500"),e.classList.remove("border-gray-100");const n=document.createElement("p");n.className="mt-1 text-xs text-red-400 field-error",n.textContent=t,e.parentNode?.insertBefore(n,e.nextSibling)}function l(e){e.classList.remove("border-red-500"),e.classList.add("border-gray-100");const t=e.parentNode?.querySelector(".field-error");t&&t.remove()}function v(e){c=e,s("amount_to_send"),s("amount_to_receive"),document.querySelectorAll(".currency-button").forEach(y=>{const d=y;d.dataset.currency===e?(d.classList.remove("bg-deep","text-gray-100"),d.classList.add("bg-green-500","text-black","active")):(d.classList.remove("bg-green-500","text-black","active"),d.classList.add("bg-deep","text-gray-100"))});const n=document.getElementById("label_recibir");n&&(n.textContent=`Recibir (${e})`);const o=document.getElementById("exchange_rate_info"),r=document.getElementById("equivalency_info"),i=document.getElementById("current_rate");if(e==="USD"||e==="CLASICA")o&&(o.style.display="none"),r&&(r.style.display="none");else if(o&&(o.style.display="block"),r&&(r.style.display="block"),i){const y=f[e];i.textContent=`1 USD = ${y} ${e}`}const a=document.getElementById("amount_to_send");a&&a.value&&I(a.value)}function I(e){const t=parseFloat(e)||0;s("amount_to_send"),s("amount_to_receive");const n=E(t,!1);if(!n.isValid){u(n.error,"amount_to_send");return}const o=Math.max(0,t-5),r=f[c],i=o*r,a=document.getElementById("amount_to_receive");a&&(a.value=i.toFixed(2)),_(t,o,i)}function M(e){const t=parseFloat(e)||0;s("amount_to_send"),s("amount_to_receive");const n=E(t,!0);if(!n.isValid){u(n.error,"amount_to_receive");return}const o=f[c],r=t/o,i=r+5;if(i>5e3){u("El monto total excede el máximo de $5000 USD","amount_to_receive");return}const a=document.getElementById("amount_to_send");a&&(a.value=i.toFixed(2)),_(i,r,t)}function _(e,t,n){const o=document.getElementById("display_neto"),r=document.getElementById("display_total"),i=document.getElementById("local_amount");S[c],o&&(c==="USD"||c==="CLASICA"?o.textContent=`${t.toFixed(2)} USD`:o.textContent=`$${t.toFixed(2)} USD`),r&&(r.textContent=`$${e.toFixed(2)} USD`),i&&c!=="USD"&&c!=="CLASICA"&&(i.textContent=`${n.toFixed(2)} ${c}`)}function C(){const e=document.getElementById("contact_email"),t=document.getElementById("contact_phone"),n=document.getElementById("tarjeta_beneficiario"),o=document.getElementById("beneficiary_address"),r=document.getElementById("amount_to_send");if(!e.value.trim()){e.focus(),m(e,"El email de contacto es requerido");return}if(!t.value.trim()){t.focus(),m(t,"El teléfono de contacto es requerido");return}if(!n.value.trim()){n.focus(),m(n,"La tarjeta del beneficiario es requerida");return}if(!o.value.trim()){o.focus(),m(o,"La dirección del beneficiario es requerida");return}const i=parseFloat(r.value)||0,a=E(i,!1);if(!a.isValid){r.focus(),u(a.error,"amount_to_send");return}g(),setTimeout(()=>{A()},100)}function g(){const e=window;e.ConfirmationUtils&&e.ConfirmationUtils.remesa_confirmation?e.ConfirmationUtils.remesa_confirmation.show():e.show_remesa_confirmation&&e.show_remesa_confirmation()}function A(){const e=document.getElementById("contact_email"),t=document.getElementById("contact_phone"),n=document.getElementById("tarjeta_beneficiario"),o=document.getElementById("beneficiary_address");e&&(e.value="",l(e)),t&&(t.value="",l(t)),n&&(n.value="",l(n)),o&&(o.value="",l(o));const r=document.getElementById("amount_to_send"),i=document.getElementById("amount_to_receive");r&&(r.value="105",s("amount_to_send")),i&&(i.value="100",s("amount_to_receive")),v("USD"),_(105,100,100)}document.addEventListener("DOMContentLoaded",function(){_(105,100,100)});window.calculateReceive=I;window.calculateSend=M;window.changeCurrency=v;window.confirmRemesa=C;
